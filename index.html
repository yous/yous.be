<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Yous</title><meta name="description" content="Blog for hackers."><link rel="stylesheet" href="/assets/main.css"><link rel="canonical" href="https://yous.be/"><link rel="alternate" type="application/rss+xml" title="Yous" href="https://yous.be/atom.xml"><link rel="icon" type="image/x-icon" href="/favicon.ico"><link rel="icon" type="image/png" href="/icon-192x192.png"><link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png"><link rel="apple-touch-icon" sizes="167x167" href="/apple-touch-icon-167x167.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png"><link rel="mask-icon" color="#2568ba" href="/safari-pinned-tab.svg"><meta name="msapplication-TileColor" content="#2568ba"><meta name="msapplication-TileImage" content="/mstile-144x144.png"><meta property="fb:admins" content="100001802412550"><meta property="og:title" content="Yous"><meta property="og:site_name" content="Yous"><meta property="og:url" content="https://yous.be/"><meta property="og:description" content="Blog for hackers."><meta property="og:image" content="http://yous.be/images/about/yous.png"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Yous"><meta name="twitter:description" content="Blog for hackers."><meta name="twitter:image:src" content="http://yous.be/images/about/yous.png"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Bitter:ital,wght@0,400;0,700;1,400&amp;display=swap" rel="stylesheet"> <script async src="https://www.googletagmanager.com/gtag/js?id=G-KZKJJ9M5EL"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-KZKJJ9M5EL'); </script><body><header class="site-header"><div class="wrapper"> <a class="site-title" href="/">Yous</a><nav class="site-nav"> <a class="page-link" href="/about/">About</a> <a class="page-link" href="/archives/">Archives</a></nav></div></header><main class="page-content" aria-label="Content"><div class="wrapper"><div class="home"><ul class="post-list"><li><header class="post-header"><h1 class="post-title"> <a class="post-link" href="/2019/01/15/integrate-homebrew-ruby-with-chruby/">Integrate Homebrew Ruby with chruby</a></h1><p class="post-meta"> Jan 15, 2019 • <a href="/categories/ruby/">Ruby</a></p></header><div class="post-content"><p>For a while after <a href="/2016/01/01/switching-rvm-to-chruby/">switching from RVM to chruby</a>, I’ve been quite satisfied with <a href="https://github.com/postmodern/chruby">chruby</a>, except for one thing. Every time Ruby releases a new version, I had to compile that version from scratch using <a href="https://github.com/postmodern/ruby-install">ruby-install</a>. It takes quite a long time, and I should do that on every macOS device I use.</p><p><a href="http://xkcd.com/303/"><img src="/images/2019/01/15/compiling.png" alt="Compiling" title="'Are you stealing those LCDs?' 'Yeah, but I'm doing it while my code compiles.'" /></a></p><h2>Why should I compile?</h2><p>I wanted to install pre-compiled Ruby. It should exist! Then I thought up Homebrew. Almost every formula of Homebrew has “bottles” for multiple versions of macOS. So I thought: ‘Just use Homebrew Ruby with chruby!’</p></div><p class="post-continue"> <a href="/2019/01/15/integrate-homebrew-ruby-with-chruby/">Read on &rarr;</a></p><li><header class="post-header"><h1 class="post-title"> <a class="post-link" href="/2018/12/02/how-to-open-binary-plist-files-using-vim-plist/">How to open binary plist files using vim-plist</a></h1><p class="post-meta"> Dec 2, 2018 • <a href="/categories/vim/">Vim</a></p></header><div class="post-content"><p><img src="/images/2018/12/02/plist.min.png" alt="Vim editing a binary plist file" /></p><p>Using macOS, you may have had experiences of handling plist files. For example, <code class="language-plaintext highlighter-rouge">~/Library/Preferences/.GlobalPreferences.plist</code> file holds some configurations of macOS. When you type <code class="language-plaintext highlighter-rouge">defaults write -g ApplePressAndHoldEnabled -bool false</code> on terminal, the following lines are added to <code class="language-plaintext highlighter-rouge">.GlobalPreferences.plist</code>:</p><div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;key&gt;</span>ApplePressAndHoldEnabled<span class="nt">&lt;/key&gt;</span>
<span class="nt">&lt;false/&gt;</span>
</code></pre></div></div><p>So when you dig down the preferences or resources of macOS system, you’ll meet plist files.</p><h2>vim-plist</h2><p>darfink’s <a href="https://github.com/darfink/vim-plist">vim-plist</a> plugin handles *.plist files quite well. A plist file is in one of three formats; json, binary, xml. macOS is bundled with the <code class="language-plaintext highlighter-rouge">plutil</code> command that can convert a plist file from one format to another. The plugin also uses <code class="language-plaintext highlighter-rouge">plutil</code> to handle read and write of plist files.</p><p>The plugin registers autocmd for <a href="https://github.com/darfink/vim-plist/blob/67280fb32b88ad75e255068dfe69b9f069421618/plugin/plist.vim#L19-L20"><code class="language-plaintext highlighter-rouge">BufReadCmd</code> and <code class="language-plaintext highlighter-rouge">FileReadCmd</code></a> to read *.plist files, <a href="https://github.com/darfink/vim-plist/blob/67280fb32b88ad75e255068dfe69b9f069421618/plugin/plist.vim#L16"><code class="language-plaintext highlighter-rouge">BufWriteCmd</code> and <code class="language-plaintext highlighter-rouge">FileWriteCmd</code></a> to write *.plist files. <code class="language-plaintext highlighter-rouge">BufRead</code> and <code class="language-plaintext highlighter-rouge">BufWrite</code> events are triggered <em>after</em> reading the file into the buffer, but <code class="language-plaintext highlighter-rouge">BufReadCmd</code> and <code class="language-plaintext highlighter-rouge">BufWriteCmd</code> events are triggered <em>before</em> reading the file, and that autocmd should handle actual read and write operation of that file. These differences make handling plist files more complex.</p></div><p class="post-continue"> <a href="/2018/12/02/how-to-open-binary-plist-files-using-vim-plist/">Read on &rarr;</a></p><li><header class="post-header"><h1 class="post-title"> <a class="post-link" href="/2017/11/14/how-to-make-a-bootable-usb-with-grub2-and-iso/">How to make a bootable USB with GRUB2 and ISO</a></h1><p class="post-meta"> Nov 14, 2017 • <a href="/categories/linux/">Linux</a></p></header><div class="post-content"><p>Do you have multiple ISO files to install, with quite enough storage of USB stick? You’ll want to install all of them with a single USB stick. Here’s how.</p></div><p class="post-continue"> <a href="/2017/11/14/how-to-make-a-bootable-usb-with-grub2-and-iso/">Read on &rarr;</a></p><li><header class="post-header"><h1 class="post-title"> <a class="post-link" href="/2017/03/07/pushing-git-repository-to-multiple-remotes/">Pushing git repository to multiple remotes</a></h1><p class="post-meta"> Mar 7, 2017 • <a href="/categories/git/">Git</a></p></header><div class="post-content"><p>I’m currently managing my dotfiles repository on both of <a href="https://github.com/yous/dotfiles">GitHub</a> and <a href="https://bitbucket.org/yous/dotfiles">Bitbucket</a>. These two repositories are the same, but I don’t want to remove one of them. I mainly use GitHub for hosting code now, but the first place I uploaded my dotfiles to was Bitbucket.</p><p>I want to keep the HEAD of two remote repositories be the same, so when I push code to my dotfiles, the both of them must be updated at the same time.</p></div><p class="post-continue"> <a href="/2017/03/07/pushing-git-repository-to-multiple-remotes/">Read on &rarr;</a></p><li><header class="post-header"><h1 class="post-title"> <a class="post-link" href="/2017/03/01/boston-key-party-ctf-2017-vimjail-write-up/">Boston Key Party CTF 2017: vimjail write-up</a></h1><p class="post-meta"> Mar 1, 2017 • <a href="/categories/ctf/">CTF</a></p></header><div class="post-content"><h2>vimjail (pwn 150)</h2><blockquote><ul><li><code class="language-plaintext highlighter-rouge">ssh ctfuser@ec2-54-200-176-5.us-west-2.compute.amazonaws.com</code><li>password: <code class="language-plaintext highlighter-rouge">loginPWforVimJail</code></ul><p>Can you read the flag?</p><p><em>UPDATES</em></p><ul><li>(13:38 UTC Saturday): The flag is not in <code class="language-plaintext highlighter-rouge">/tmp</code>.<li>(13:31 EST Saturday): new ip</ul></blockquote><h2>Looking around</h2><p>Well, you would do <code class="language-plaintext highlighter-rouge">ls</code> first when you logged in, so do we. And there was <code class="language-plaintext highlighter-rouge">~/flagReader</code>.</p><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ctfuser@ip-172-31-31-196:~<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-als</span> /home/ctfuser/flagReader
12 <span class="nt">---S--x---</span> 1 topsecretuser secretuser 8768 Feb 25 08:42 /home/ctfuser/flagReader
</code></pre></div></div><p>If you try completion by pressing Tab key or try to move around using <code class="language-plaintext highlighter-rouge">cd</code>, it fails with an error message from rbash. It’s restricted bash, but you can simply run <code class="language-plaintext highlighter-rouge">bash</code> to escape.</p><p>While moving around, we found nothing special without <code class="language-plaintext highlighter-rouge">/.flag</code>. Also there were some <code class="language-plaintext highlighter-rouge">.s[a-z][a-z]</code> files under <code class="language-plaintext highlighter-rouge">/var/tmp/</code> and <code class="language-plaintext highlighter-rouge">/tmp/</code>, created by <code class="language-plaintext highlighter-rouge">secretuser</code>. But there are not in fixed location when the problem server was changed, so we thought there would be a way to run Vim under <code class="language-plaintext highlighter-rouge">secretuser</code>’s permission.</p><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ctfuser@ip-172-31-31-196:~<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-als</span> /.flag
4 <span class="nt">-r--------</span> 1 topsecretuser topsecretuser 39 Feb 25 08:42 /.flag
</code></pre></div></div><p>We also tried to find setuid or setgid files, but there was only the previous <code class="language-plaintext highlighter-rouge">flagReader</code>.</p><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ctfuser@ip-172-31-31-196:/tmp<span class="nv">$ </span>find / <span class="nt">-perm</span> <span class="nt">-4000</span> <span class="nt">-o</span> <span class="nt">-perm</span> <span class="nt">-2000</span> <span class="nt">-type</span> f 2&gt;/dev/null
/bin/ping
/bin/ping6
/bin/fusermount
/bin/umount
/bin/su
/bin/mount
/bin/ntfs-3g
/sbin/unix_chkpwd
/sbin/pam_extrausers_chkpwd
/usr/lib/x86_64-linux-gnu/utempter/utempter
/usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic
/usr/lib/openssh/ssh-keysign
/usr/lib/snapd/snap-confine
/usr/lib/eject/dmcrypt-get-device
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/policykit-1/polkit-agent-helper-1
/usr/bin/crontab
/usr/bin/newuidmap
/usr/bin/at
/usr/bin/chage
/usr/bin/sudo
/usr/bin/bsd-write
/usr/bin/pkexec
/usr/bin/chfn
/usr/bin/expiry
/usr/bin/newgrp
/usr/bin/screen
/usr/bin/chsh
/usr/bin/gpasswd
/usr/bin/newgidmap
/usr/bin/ssh-agent
/usr/bin/passwd
/usr/bin/mlocate
/home/ctfuser/flagReader
</code></pre></div></div></div><p class="post-continue"> <a href="/2017/03/01/boston-key-party-ctf-2017-vimjail-write-up/">Read on &rarr;</a></p></ul><div class="pagination"> <a class="previous" href="/posts/2/">&laquo; Older</a></div></div></div></main><footer class="site-footer"><div class="wrapper"><p> Content on this site is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a><br /> &copy; 2013&ndash;2022 - <a href="/about/">Yous</a> - Powered by <a href="https://jekyllrb.com">Jekyll</a> &amp; <a href="https://github.com/yous/whiteglass">whiteglass</a> - Subscribe via <a href="https://yous.be/atom.xml">RSS</a></p></div></footer>
